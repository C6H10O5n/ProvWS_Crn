; Scenario: t00a_2022updates_base
; Saved on Nov 17 2022 at 1:49:18 pm
{==================================================================}
{                          /\     Nova Scotia                      }
{                         /  \    Department of Natural Resources  }
{                        /    \   Forestry Division                }
{ Tel:   (902)-893-5696 /______\  Forest Management Planning       }
{ Fax:   (902)-893-6102    |      Resource Analysis Group          }
{==================================================================}

*GROUP EBM ;<GROUP>

  ;EBM-Theme1 Based
  ;-----------------------------------------------------------
  FOREACH XX IN(EM,CF,NULL) ;Triad
    FOREACH ZZ IN(FLB,WLB,RLB) ;Landbase
      FOREACH VV IN(#opPNVs,NULL) ;PNV

        ;EBM Zone: ZZ Landbase Area Totals
        ;-------------------------------------------------------------
        *OUTPUT oELChaZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Total ELC/NDR Area - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA

        ;EBM Zone: ZZ 10-yr Ageclass
        ;--------------------------------------------------------
        FOREACH YY IN (2..40,2)
          *OUTPUT oELChaZZagx.EQUATION(YY * 5).IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)
            *SOURCE ? ? ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @AGE(.EQUATION(YY - 1)..YY) _INVENT _AREA
        ENDFOR
        *OUTPUT oELChaZZagx200p.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)
          *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @AGE(41.._MAXAGE) _INVENT _AREA


        ;EBM Zone: ZZ by State
        ;-------------------------------------------------------------
        FOREACH YY IN (#TH10Rep)
          *OUTPUT oELChaZZstYY.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)   Total ELC/NDR Area - ElcUnit:ThemeBased - Landbase:ZZ - State:YY.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? YY ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA
        ENDFOR


        ;Development Class <GROUP>
        ;-------------------------------------------------------------

          ;Base Classes
          *OUTPUT oEstZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Establishment Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,1) _INVENT _AREA
          *OUTPUT oYngZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Young Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,2) _INVENT _AREA
          *OUTPUT oMatZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Mature Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,3..4) _INVENT _AREA
          *OUTPUT oOldZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the  Multi-Aged/Old Forest Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,5) _INVENT _AREA


          ;MAT Split 1,2 [40-80; 80-120]
          *OUTPUT oMt1ZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Mature-1 Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,3) _INVENT _AREA
          *OUTPUT oMt2ZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Mature-2 Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,4) _INVENT _AREA


          ;MAT+OLD
          *OUTPUT oMtoZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Combined Mature1 & Mature2 & Multi-Aged/Old Forest Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,3..5) _INVENT _AREA


          ;EST+YNG
          *OUTPUT oEsyZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)  Area in the Combined Establishment & Young Forest Development Class - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yDevCls,1..2) _INVENT _AREA


          ;Development Class Percents
          *OUTPUT oOldPZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) %Old - ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE oOldZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) / oELChaZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) * 100
          *OUTPUT oMtoPZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) %Mto - ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE oMtoZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) / oELChaZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) * 100
          *OUTPUT oEsyPZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) %Esy - ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE oEsyZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) / oELChaZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) * 100

        ;<ENDGROUP> Development Class


        ;Seral Stage Class <GROUP>
        ;-------------------------------------------------------------

          ;Base Classes
          *OUTPUT oEarZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in an Early Seral Stage - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(ySerDevCls,13..15) _INVENT _AREA
          *OUTPUT oMidZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in an Mid Seral Stage - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(ySerDevCls,23..25) _INVENT _AREA
          *OUTPUT oLatZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in an Late Seral Stage - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(ySerDevCls,33..35) _INVENT _AREA


          ;Seral Class Percents
          *OUTPUT oLatPZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) %Lat - ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE oLatZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) /  oMtoZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX) * 100

        ;<ENDGROUP> Seral Class


        ;Forest Community <GROUP>
        ;-------------------------------------------------------------

          ;Base Classes
          *OUTPUT oHIHwZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)       Area in a HIHw(101) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,101) _INVENT _AREA
          *OUTPUT oHITHwZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)      Area in a HITHw(102) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,102) _INVENT _AREA
          *OUTPUT oHTHwZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)       Area in a HTHw(103) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,103) _INVENT _AREA
          *OUTPUT oMIHwHSZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in a MIHwHS(201) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,201) _INVENT _AREA
          *OUTPUT oMIHwSHZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in a MIHwSH(202) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,202) _INVENT _AREA
          *OUTPUT oMTHwZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)       Area in a MTHw(203) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,203) _INVENT _AREA
          *OUTPUT oSrSbSDomZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)   Area in a SrSbSDom(301) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,301) _INVENT _AREA
          *OUTPUT oSwSDomZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in a SwSDom(302) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,302) _INVENT _AREA
          *OUTPUT oSbFDomZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in a SbFDom(303) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,303) _INVENT _AREA
          *OUTPUT oSSpbFDomZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)   Area in a SSpbFDom(304) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,304) _INVENT _AREA
          *OUTPUT oSPiDomZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)     Area in a SPiDom(305) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,305) _INVENT _AREA
          *OUTPUT oSMHePiSpZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1)   Area in a SMHePiSp(306) Forest Community - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,306) _INVENT _AREA
          *OUTPUT oUnkForCommZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) Area in an Undetermined Forest Community(0) - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yForComm,0) _INVENT _AREA

        ;<ENDGROUP> Forest Community


        ;Individual Species Inventory Volume <GROUP>
        ;-------------------------------------------------------------

          FOREACH SS IN(T,S,H,SPBF,PIEHTL,RS,BS,WS,BF,WP,RP,EH,TL,RM,WB,XA,SM,BE,YB,RO)
            *OUTPUT oVolSSZZ.IF(VV=NULL,,VV).IF(XX=NULL,,tXX)(_TH1) Invnetory Volume - Species:SS - ElcUnit:ThemeBased - Landbase:ZZ.IF(VV=NULL, , PNV:VV).IF(XX=NULL, , Triad Zone XX)
              *SOURCE ? ? .IF(VV=NULL,?,VV) ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT ySSv
          ENDFOR

        ;<ENDGROUP> Individual Species Inventory Volume
      ENDFOR ;VV PNV
    ENDFOR ;ZZ Landbase
  ENDFOR ;XX Triad Zone

  ;EBM Percentages By ER/NDR
  ;-----------------------------------------------------------
  FOREACH ZZ IN (#opEUs)
    FOREACH XX IN (#opZZEUs)
      FOREACH YY IN (Flb,Wlb,Rlb) ;Landbase

        *OUTPUT oELChaYYXX  XX - YY
          *SOURCE XX ? ? ? ? ? ? ? ? ? YY YY ? ? ? _INVENT _AREA

        *OUTPUT oOldYYXX OLD - XX - YY
          *SOURCE XX ? ? ? ? ? ? ? ? ? YY YY ? ? ? @YLD(yDevCls,5) _INVENT _AREA
        *OUTPUT oM2oYYXX  M2O - XX - Landbase:YY
          *SOURCE XX ? ? ? ? ? ? ? ? ? YY YY ? ? ? @YLD(yDevCls,4..5) _INVENT _AREA
        *OUTPUT oMtoYYXX  MTO - XX - Landbase:YY
          *SOURCE XX ? ? ? ? ? ? ? ? ? YY YY ? ? ? @YLD(yDevCls,3..5) _INVENT _AREA
        *OUTPUT oLatYYXX  LAT - XX - Landbase:YY
          *SOURCE XX ? ? ? ? ? ? ? ? ? YY YY ? ? ? @YLD(ySerDevCls,33..35) _INVENT _AREA

        *OUTPUT oOldYYPXX %OLD - XX - YY
          *SOURCE oOldYYXX / oELChaYYXX * 100
        *OUTPUT oM2oYYPXX %M2O - XX - YY
          *SOURCE oM2oYYXX / oELChaYYXX * 100
        *OUTPUT oMtoYYPXX %MTO - XX - YY
          *SOURCE oMtoYYXX / oELChaYYXX * 100
        *OUTPUT oLatYYPXX %LAT - XX - YY
          *SOURCE oLatYYXX / oELChaYYXX * 100

      Endfor
    ENDFOR
  ENDFOR

  ;PNV MDAR Percentages By ER/NDR
  ;-----------------------------------------------------------
  FOREACH XX IN(EM,CF,NULL) ;Triad
    FOREACH ZZ IN (#opPNVs,NULL) ;PNV
      FOREACH YY IN (L,M,H) ;Severity Class

        *OUTPUT oELCha.IF(ZZ=NULL,,pnvZZ)madrYY.IF(XX=NULL,,tXX)(_TH1)  MADR Area - ElcUnit:ThemeBased - PNV: ZZ - Severity: YY.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? .IF(ZZ=NULL,?,ZZ) ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) _INVENT yMadrYY

      ENDFOR
    ENDFOR
  ENDFOR

 ;NBM SusMAI Class by EMT
  ;-----------------------------------------------------------
  FOREACH XX IN (#th13rep)
    *OUTPUT  oNBMclsXXbyEMT1
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,10..11) _INVENT _AREA
    *OUTPUT  oNBMclsXXbyEMT2
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,20..21) _INVENT _AREA
    *OUTPUT  oNBMclsXXbyEMT3
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,30..32) _INVENT _AREA
    *OUTPUT  oNBMclsXXbyEMT4
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,40..42) _INVENT _AREA
    *OUTPUT  oNBMclsXXbyEMT5
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,50..52) _INVENT _AREA
    *OUTPUT  oNBMclsXXbyEMT6
      *SOURCE  ? ? ? ? ? ? ? ? ? ? ? ? XX ? ?   @YLD(yEMT,60..61) _INVENT _AREA
  ENDFOR

;<ENDGROUP> EBM



*GROUP Wildlife ; <GROUP>

  FOREACH XX IN(EM,HF,NULL) ;Triad
    FOREACH ZZ IN (FLB,WLB,RLB) ;Landbase

      ;Combined Moose/DWA/Marten
      ;--------------------------------------------------------
      *OUTPUT oWildlifeHaZZ.IF(XX=NULL,,tXX) Total ZZ Area Within a Wildlife (Moose,DWA,Marten) Zone - ha.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ? CRNALL ? ? wMoose  ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA +
                ? CRNALL ? ? wDWA    ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA +
                ? CRNALL ? ? wMarten ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA


      ;Moose
      ;--------------------------------------------------------
      *OUTPUT oMooseHaZZCrnSwd.IF(XX=NULL,,tXX)(_TH1) Area Within Moose Zone of Total Softwood on ZZ - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ? CRNALL ? ? wMoose ? SWD ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA
      *OUTPUT oMooseHaZZCrnMatSwd.IF(XX=NULL,,tXX)(_TH1) Area Within Moose Zone of Mature Softwood on ZZ - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ? CRNALL ? ? wMoose ? SWD ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @AGE(8.._MAXAGE) _INVENT _AREA


      ;Deer
      ;--------------------------------------------------------
      *OUTPUT oDeerHaZZCrnSwd.IF(XX=NULL,,tXX)(_TH1) Area Within Deer Zone of Total Softwood on ZZ - ElcUnit:ThemeBased - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ? CRNALL ? ? wDWA ? SWD ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA
      *OUTPUT oDeerHaZZCrnMatSwd.IF(XX=NULL,,tXX)(_TH1) Area Within Deer Zone of Mature Softwood on ZZ -ElcUnit:ThemeBased - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ? CRNALL ? ? wDWA ? SWD ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @AGE(8.._MAXAGE) _INVENT _AREA

      ;Wood Turtle
      ;--------------------------------------------------------
      ;*OUTPUT oWtrtHaZZCrn.IF(XX=NULL,,tXX)(_TH1) Area Within Wood Turtle Habitat on ZZ - ElcUnit:ThemeBased - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        ;*SOURCE ? CRNALL ? ? WTR ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA


      ;BFL 200-500m buffer Management Zone
      ;--------------------------------------------------------
      ;*OUTPUT oBflHaZZCrn.IF(XX=NULL,,tXX)(_TH1) Area Within BFL 200-500m Buffer on ZZ - ElcUnit:ThemeBased - ha, Owner: Crown.IF(XX=NULL, , Triad Zone XX)
        ;*SOURCE ? CRNALL ? ? BFL ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA


      ;PHP Wildlife Indicator Species on Eastern Crown:
      ;--------------------------------------------------------
        ;Landbase Area
          *OUTPUT oPHPELChaZZ.IF(XX=NULL,,tXX)(_TH1)  Total ELC/NDR Area - ElcUnit:ThemeBased - Landbase:ZZ.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) _INVENT _AREA
        ;Peilated Woodpecker
          *OUTPUT oHabPilPeckerZZ.IF(XX=NULL,,tXX)(_TH1) PHP Habitat - Peilated Woodpecker - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? CRNEAST ? ? ? ? PilPeckerSHX ? ? SHall ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA +
                    ? CRNEAST ? ? ? ? PilPeckerNAT ? ? NAT   ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA
        ;Barred Owl
          *OUTPUT oHabBarredOwlZZ.IF(XX=NULL,,tXX)(_TH1) PHP Habitat -Barred Owl - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? CRNEAST ? ? ? ? BarredOwl ? ? SHall ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA +
                    ? CRNEAST ? ? ? ? BarredOwl ? ? NAT   ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA
        ;Bicknell Thrust
          *OUTPUT oHabBickThrushZZ.IF(XX=NULL,,tXX)(_TH1) PHP Habitat -Bicknell Thrust - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ER2 CRNEAST ? ? ? ? BickThrush ? ? NAT ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 10..15) _INVENT _AREA
        ;Black Backed Woodpecker
          *OUTPUT oHabBBPeckerZZ.IF(XX=NULL,,tXX)(_TH1) PHP Habitat - Black Backed Woodpecker - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? CRNEAST ? ? ? ? BBPeckerWWCross ? ? SHall ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA +
                    ? CRNEAST ? ? ? ? BBPeckerWWCross ? ? NAT   ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA
        ;White Winged Cross Billed
          *OUTPUT oHabWWCrossZZ.IF(XX=NULL,,tXX)(_TH1) PHP Habitat - White Winged Cross Billed - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ? CRNEAST ? ? ? ? BBPeckerWWCross ? ? SHall ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA +
                    ? CRNEAST ? ? ? ? BBPeckerWWCross ? ? NAT   ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT _AREA


      ;PHP Wildlife FSC Species Habitat Indicators:
      ;--------------------------------------------------------
        *OUTPUT oWarblerZZ.IF(XX=NULL,,tXX)(_TH1) Warbler Habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..90) _INVENT yWarblerHwPerc
        *OUTPUT oChimneySwiftZZ.IF(XX=NULL,,tXX)(_TH1) Chimney Swift Habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..70) _INVENT yChimneyHwPerc
        *OUTPUT oNightHawkZZ.IF(XX=NULL,,tXX)(_TH1) Night Hawk Habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..999) _INVENT yNightHawkHwPerc
        *OUTPUT oPeeweeHabZZ.IF(XX=NULL,,tXX)(_TH1) Eastern Wood Peewee Habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..70) _INVENT yPeeweeHwPerc
        *OUTPUT oWhipoorwillHabZZ.IF(XX=NULL,,tXX)(_TH1) Eastern whip poor will habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..30) _INVENT yWhipoorwillHwPerc
        *OUTPUT oGrossbeakHabZZ.IF(XX=NULL,,tXX)(_TH1) Evening grossbeak  habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..999) _INVENT yGrossbeakHwPerc
        *OUTPUT oOliveMWHab_step1ZZ.IF(XX=NULL,,tXX)(_TH1) Olive fly catcher mw component     ; just the mw compnent
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..30) _INVENT yOliveMWHwPerc
        *OUTPUT oOliveSWHab_step2ZZ.IF(XX=NULL,,tXX)(_TH1) Olive fly catcher sw component      ; just the sw compnent
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..999) _INVENT yOliveSWHwPerc
        *OUTPUT oOliveHabZZ.IF(XX=NULL,,tXX)(_TH1) Olive sided fly catcher habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE oOliveMWHab_step1ZZ.IF(XX=NULL,,tXX) + oOliveSWHab_step2ZZ.IF(XX=NULL,,tXX)
        *OUTPUT oRustyBlackBirdHabZZ.IF(XX=NULL,,tXX)(_TH1) Rusty Black bird habitat - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 0..10) _INVENT yRustyHwPerc
        *OUTPUT oWoodThrushHabZZ.IF(XX=NULL,,tXX)(_TH1) Wood ThrushHab - ElcUnit:ThemeBased - Landbase:ZZ - ha.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? CRNEAST ? ? ? ? ? ? ? ? ZZ ZZ ? ? .IF(XX=NULL,?,XX) @YLD(yAge, 40..70) _INVENT yWoodThrushHwPerc

    ENDFOR ;ZZ Landbase
  ENDFOR ;XX Triad Zone
;<ENDGROUP> Wildlife


*GROUP High Production Forestry ; <GROUP>

  ;Area Clearcut to Go Into HPF
  ;--------------------------------------------------------
  *output oHFXareaCC(_TH2) Area Clearcut to Go Into HPF
    *Source ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HFX aCC _AREA
  *output oHFXareaRegen(_TH2) Regen Area Going Into HPF
    *Source ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HFX aHFregen _AREA
  *output oHFXareaRemoved(_TH2) Suitable Area Removed from HPF
    *Source ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HFX aHFremove _AREA


  ;Area On RX by Spp
  ;--------------------------------------------------------
  *OUTPUT oHpfOnRxNsByMu(_th2) HPF-RxNS Area: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxNS
  *OUTPUT oHpfOnRxWsByMu(_th2) HPF-RxWS Area: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxWS
  *OUTPUT oHpfOnRxRsByMu(_th2) HPF-RxRS Area: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxRS
  *OUTPUT oHpfOnRxAllByMu(_th2) HPF-AllRx Area: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxNS +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxWS +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxRS

    ;Operational Adjustment Factor
    *OUTPUT oHpfOnRxNsByMusf(_TH2) AHPF-RxNS Area: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxNS * ySFosf
    *OUTPUT oHpfOnRxWsByMusf(_TH2) AHPF-RxWS Area: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxWS * ySFosf
    *OUTPUT oHpfOnRxRsByMusf(_TH2) AHPF-RxRS Area: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxRS * ySFosf
    *OUTPUT oHpfOnRxAllByMusf(_TH2) AHPF-RxAll Area: ManagementUnit:ThemeBased with Operational Adjustment Factor

    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxNS * ySFosf +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxWS * ySFosf +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF _INVENT yOnHpfRxRS * ySFosf


  ;Area Ini RX by Spp
  ;--------------------------------------------------------
  *OUTPUT oHpfIniRxNsByMu(_th2) HPF-RxNS Area Strated: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxNS
  *OUTPUT oHpfIniRxWsByMu(_th2) HPF-RxWS Area Started: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxWS
  *OUTPUT oHpfIniRxRsByMu(_th2) HPF-RxRS Area Started: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxRS
  *OUTPUT oHpfIniRxAllByMu(_th2) HPF-AllRx Area Started: ManagementUnit:ThemeBased
    *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxNS +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxWS +
            ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF rHF yIniHpfRxRS

    ;Operational Adjustment Factor
    *OUTPUT oHpfIniRxNsByMusf(_TH2) AHPF-RxNS Area Started: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE oHpfIniRxNsByMu * ySFosf
    *OUTPUT oHpfIniRxWsByMusf(_TH2) AHPF-RxWS Area Started: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE oHpfIniRxWsByMu * ySFosf
    *OUTPUT oHpfIniRxRsByMusf(_TH2) AHPF-RxRS Area Started: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE oHpfIniRxRsByMu * ySFosf
    *OUTPUT oHpfIniRxAllByMusf(_TH2) AHPF-RxAll Area Started: ManagementUnit:ThemeBased with Operational Adjustment Factor
      *SOURCE oHpfIniRxAllByMu * ySFosf


  ;Area by RX Target Diameter
  ;--------------------------------------------------------
    *OUTPUT oHpfOnRxPz08ByMu(_th2) HPF-RxPz08 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,08) _INVENT _AREA
    *OUTPUT oHpfOnRxPz10ByMu(_th2) HPF-RxPz10 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,10) _INVENT _AREA
    *OUTPUT oHpfOnRxPz12ByMu(_th2) HPF-RxPz12 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,12) _INVENT _AREA

    ;Area by RX Target Diameter: With Scalefactor
    *OUTPUT oHpfOnRxPz08ByMusf(_th2) HPF-RxPz08 Area: ManagementUnit:ThemeBased with Operational Scalefactor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,08) _INVENT _AREA * ySFosf
    *OUTPUT oHpfOnRxPz10ByMusf(_th2) HPF-RxPz10 Area: ManagementUnit:ThemeBased with Operational Scalefactor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,10) _INVENT _AREA * ySFosf
    *OUTPUT oHpfOnRxPz12ByMusf(_th2) HPF-RxPz12 Area: ManagementUnit:ThemeBased with Operational Scalefactor
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPF @YLD(yOnHpfRxPsz,12) _INVENT _AREA * ySFosf


  ;Area by Land Ranking
  ;--------------------------------------------------------
    *OUTPUT oHpfIniRxRk1ByMu(_th2) HPF-RxRk1 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPS1 aCC _AREA
    *OUTPUT oHpfIniRxRk2ByMu(_th2) HPF-RxRk2 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPS2 aCC _AREA
    *OUTPUT oHpfIniRxRk3ByMu(_th2) HPF-RxRk3 Area: ManagementUnit:ThemeBased
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? HPS3 aCC _AREA


    ;Area by Land Ranking: With Scalefactor
      *OUTPUT oHpfIniRxRk1ByMusf(_th2) HPF-RxRk1 Area: ManagementUnit:ThemeBased with Operational Scalefactor
        *SOURCE oHpfIniRxRk1ByMu * ySFosf
      *OUTPUT oHpfIniRxRk2ByMusf(_th2) HPF-RxRk2 Area: ManagementUnit:ThemeBased with Operational Scalefactor
        *SOURCE oHpfIniRxRk2ByMu * ySFosf
      *OUTPUT oHpfIniRxRk3ByMusf(_th2) HPF-RxRk3 Area: ManagementUnit:ThemeBased with Operational Scalefactor
        *SOURCE oHpfIniRxRk3ByMu * ySFosf

;<ENDGROUP> High Production Forestry


*GROUP Working Landbase ; <GROUP>
  FOREACH XX IN(HF,EM,NULL,HFX,HPF) ;Triad

    ;WLB
    ;--------------------------------------------------------
    *OUTPUT ohaFH.IF(XX=NULL,,tXX)   Landbase(ha):Working Forest.IF(XX=NULL, , Triad Zone XX)
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) _INVENT _AREA


    ;WLB by ManagementUnit
    ;--------------------------------------------------------
    *OUTPUT ohaFHbyMU.IF(XX=NULL,,tXX)(_TH2)   Landbase(ha):Working Forest, MU:ThemeBased.IF(XX=NULL, , Triad Zone XX)
      *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) _INVENT _AREA

      ;by MU by State
      FOREACH ZZ IN (#TH10Rep)
        *OUTPUT ohaFHbyMUstZZ.IF(XX=NULL,,tXX)(_TH2)   Landbase(ha):Working Forest, MU:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) _INVENT _AREA
      ENDFOR


    ;WLB by 20yr-Ageclass/State
    ;--------------------------------------------------------
    FOREACH ZZ IN (#TH10Rep, ALL)

      FOREACH YY IN (4..20,4)
        *OUTPUT ohaFHbyMUstZZag.EQUATION(YY * 5).IF(XX=NULL,,tXX)(_TH2) Landbase(ha):Working Forest, MU:ThemeBased, State:ZZ, 20yr-Ageclass:YY.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) @AGE(.EQUATION(YY - 3)..YY) _INVENT _AREA
      ENDFOR
      *OUTPUT ohaFHbyMUstZZag100p.IF(XX=NULL,,tXX)(_TH2)
        *SOURCE ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) @AGE(21.._MAXAGE) _INVENT _AREA

    ENDFOR


    ;WLB by 10yr-Ageclass/State
    ;--------------------------------------------------------
    FOREACH ZZ IN (#TH10Rep, ALL)

      FOREACH YY IN (2..40,2)
        *OUTPUT ohaFHbyMUstZZagx.EQUATION(YY * 5).IF(XX=NULL,,tXX)(_TH2) Landbase(ha):Working Forest, MU:ThemeBased, State:ZZ, 10yr-Ageclass:YY.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) @AGE(.EQUATION(YY - 1)..YY) _INVENT _AREA
      ENDFOR
      *OUTPUT ohaFHbyMUstZZagx200p.IF(XX=NULL,,tXX)(_TH2)
        *SOURCE ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) @AGE(41.._MAXAGE) _INVENT _AREA

    ENDFOR

    ;WLB by Ecologial Matrix Treatment Eligibility
    ;--------------------------------------------------------
    FOREACH ZZ IN (10..60,10)
      *OUTPUT ohaFHbyMUemtZZ.IF(XX=NULL,,tXX)(_TH2)     Landbase(ha):Working Forest, MU:ThemeBased, yEMT:ZZ
        *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) @YLD(yEMT,ZZ...EQUATION(ZZ + 1)) _INVENT _AREA
    ENDFOR
    FOREACH ZZ IN (11,21,31,41,51,61)
      *OUTPUT ohaFHbyMUemtZZ.IF(XX=NULL,,tXX)(_TH2)     Landbase(ha):Working Forest, MU:ThemeBased, yEMT:ZZ
        *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) @YLD(yEMT,ZZ) _INVENT _AREA
    ENDFOR

    ;WLB by Ecologial Matrix LIT Class
    ;--------------------------------------------------------
    FOREACH ZZ IN (10..100,10)
      *OUTPUT ohaFHbyMUlitZZ.IF(XX=NULL,,tXX)(_TH2)     Landbase(ha):Working Forest, MU:ThemeBased, yLIT:ZZ
        *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) @YLD(yLITp,.EQUATION(ZZ - 9)..ZZ) _INVENT _AREA
    ENDFOR

  ENDFOR ;XX Triad Zone
;<ENDGROUP> Working Landbase


*GROUP FiberFlows ; <GROUP>
  FOREACH XX IN(HF,EM,NULL)
    FOREACH KK IN (S,H,SPBF,PIEHTL) ;,SMYB,IHBERO)

      ;Harvest
      ;--------------------------------------------------------
      *OUTPUT oacHVvKKbyMU.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#acHV)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
        ENDFOR


      ;Harvest by MU
      ;--------------------------------------------------------
      FOREACH ZZ IN(#opMUs,CRNALL,MUALL)
        *OUTPUT oacHVvKKmuZZ.IF(XX=NULL,,tXX) KK Harvest(acHV) - m3/period, ManagementUnit:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ? ZZ ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR


      ;Harvest by MU by Product
      ;--------------------------------------------------------
      FOREACH ZZ IN(LOG,STD,PLP) ;IF(KK = SPBF*)
        *OUTPUT oacHVvKKprZZbyMU.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, Product:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKVZZ .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR
      *OUTPUT oacHVvKKprSldbyMU.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, Product:SLD.IF(XX=NULL, , Triad Zone XX)
        *SOURCE oacHVvKKprSTDbyMU.IF(XX=NULL,,tXX) +
                oacHVvKKprLOGbyMU.IF(XX=NULL,,tXX)


      ;Harvest by MU by Discount Factor
      ;--------------------------------------------------------
      FOREACH ZZ IN (DF10%,DF4%) ;,DF50,PER1)
        *OUTPUT oacHVvKKbyMUZZ.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, DiscountFactor:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV * yZZ .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR


      ;Harvest by MU by State
      ;--------------------------------------------------------
      FOREACH ZZ IN (#TH10Rep)
        *OUTPUT oacHVvKKbyMUstZZ.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ZZ WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR


      ;Harvest by MU by Site
      ;--------------------------------------------------------
      FOREACH ZZ IN (#TH09Rep)
        *OUTPUT oacHVvKKbyMUscZZ.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, SiteClass:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ZZ ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR

      ;Harvest by Ecolocial Units
      ;--------------------------------------------------------
      *OUTPUT oacHVvKKbyEU.IF(XX=NULL,,tXX)(_TH1) KK Harvest(acHV) - m3/period, EcologicalUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#acHV)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
        ENDFOR

      ;Harvest by MU by Modelled Ecolocial Units
      ;--------------------------------------------------------
      FOREACH ZZ IN (#opEUs)
        *OUTPUT oacHVvKKbyMUeuZZ.IF(XX=NULL,,tXX)(_TH2) KK Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, Ecodistrict:ZZ.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#acHV)
            .IF(YY.rec = 1,*SOURCE,       ) ZZ ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR


      ;Harvest by MU by Harvest Action
      ;--------------------------------------------------------
      FOREACH ZZ IN (#acHVgr)
        *OUTPUT oZZvKKbyMU.IF(XX=NULL,,tXX)(_TH2) KK Harvested (ZZ Actions) - m3/period, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#ZZ)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKV .IF(YY.rec < YY.count,+)
          ENDFOR
      ENDFOR

    ENDFOR ;KK Species Group
  ENDFOR ;XX Triad Zone
;<ENDGROUP> Fiber Flows


*GROUP FiberFlows:Scaled ; <GROUP>
  FOREACH XX IN(HF,EM,NULL)

    ;Scaled Harvests
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF,PIEHTL)
      *OUTPUT oacHVvSSbyMU.IF(XX=NULL,,tXX)sf(_TH2)  SS Harvest(acHV) - m3/period, ManagementUnit:ThemeBased,.IF(XX=NULL, , Triad Zone XX)  Scaled
        *SOURCE oacHVvSSbyMU.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
    ENDFOR


    ;Scaled Harvests Discount Factor
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF,PIEHTL)
      FOREACH ZZ IN (DF10%,DF4%) ;,DF50,PER1)
        *OUTPUT oacHVvSSbyMU.IF(XX=NULL,,tXX)sfZZ(_TH2)  SS Harvest(acHV) - m3/period, ManagementUnit:ThemeBased,.IF(XX=NULL, , Triad Zone XX)  Scaled, DF10%
          *SOURCE oacHVvSSbyMU.IF(XX=NULL,,tXX)sf * yZZ
      ENDFOR
    ENDFOR

    ;Scaled Harvests By ManagementUnit
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      FOREACH ZZ IN(#opMUs,CRNALL,MUALL)
        *OUTPUT oacHVvSSmuZZ.IF(XX=NULL,,tXX)sf  SS Harvest(acHV) - m3/period, ManagementUnit:ZZ,.IF(XX=NULL, , Triad Zone XX)  Scaled
          *SOURCE oacHVvSSmuZZ.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
      ENDFOR
    ENDFOR


    ;Scaled Harvests By Product
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      FOREACH ZZ IN(LOG,STD,PLP,SLD)
        *OUTPUT oacHVvSSprZZbyMU.IF(XX=NULL,,tXX)sf(_TH2) SS Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, Product:ZZ,.IF(XX=NULL, , Triad Zone XX)  Scaled
          *SOURCE oacHVvSSprZZbyMU.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
      ENDFOR
    ENDFOR


    ;Scaled Harvests By Product with Discount Factor
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      FOREACH ZZ IN(LOG,STD,PLP,SLD)
        FOREACH KK IN (DF10%,DF4%) ;,DF50,PER1)
          *OUTPUT oacHVvSSprZZbyMU.IF(XX=NULL,,tXX)sfKK(_TH2) SS Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, Product:ZZ,.IF(XX=NULL, , Triad Zone XX)  Scaled
            *SOURCE oacHVvSSprZZbyMU.IF(XX=NULL,,tXX)sf * yKK
        ENDFOR
      ENDFOR
    ENDFOR


    ;Scaled Harvests MU by State
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      FOREACH ZZ IN (#TH10Rep)
        *OUTPUT oacHVvSSbyMUstZZ.IF(XX=NULL,,tXX)sf(_TH2) SS Harvest(acHV) - m3/period, ManagementUnit:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)  Scaled
          *SOURCE oacHVvSSbyMUstZZ.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
      ENDFOR
    ENDFOR


    ;Scaled Harvests By Ecological Unit By Species
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      *OUTPUT oacHVvSSbyEU.IF(XX=NULL,,tXX)sf(_TH1) SS Harvest(acHV) - m3/period, EcologicalUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        *SOURCE oacHVvSSbyEU.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
    ENDFOR


    ;Scaled Harvests MU by Harvest Action
    ;-------------------------------------------------------------
    FOREACH SS IN(H,S,SPBF)
      FOREACH ZZ IN (#acHVgr)
        *OUTPUT oZZvSSbyMU.IF(XX=NULL,,tXX)sf(_TH2) SS Harvested (ZZ Actions) - m3/period, ManagementUnit:ThemeBased,.IF(XX=NULL, , Triad Zone XX)  Scaled
          *SOURCE oZZvSSbyMU.IF(XX=NULL,,tXX) * .IF(SS=H,ySFosfht,ySFosfst)
      ENDFOR
    ENDFOR
  ENDFOR ;XX Triad Zone
;<ENDGROUP> FiberFlows-HarvestWithScaleFactors


*GROUP GrowingStock ; <GROUP>
  ;Growing Stock (m3)
  FOREACH XX IN(HF,EM,NULL)
    FOREACH KK IN (S,H,SPBF) ;,PIEHTL,SMYB,IHBERO)
        *OUTPUT ogsvKKbyMU.IF(XX=NULL,,tXX)(_TH2) KK GrowingStock - m3, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) _INVENT YKKV
        *OUTPUT ogsvKKbyMU.IF(XX=NULL,,tXX)gmt(_TH2) KK GrowingStock - gmt, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ? ? ? ? ? ? ? ? ? ? WLB WLB ? ? .IF(XX=NULL,?,XX) _INVENT YKKV * .IF(KK=H,yhM3toGmt,ysM3toGmt)
    ENDFOR ;KK Species Group
  ENDFOR ;XX Triad Zone
;<ENDGROUP> GrowingStock


*GROUP TreatmentArea ; <GROUP>
  FOREACH XX IN(HF,EM,NULL) ;Triad
    FOREACH KK IN (#acList) ;Actions

      ;Area (ha)
      *OUTPUT ohvKKHabyMU.IF(XX=NULL,,tXX)(_TH2) Area Harvested (KK Actions) - ha, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#KK)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") _AREA .IF(YY.rec < YY.count,+)
        ENDFOR

      ;with Operational Scalefactor [osf,osf_mos]
      *OUTPUT ohvKKHabyMU.IF(XX=NULL,,tXX)sf(_TH2) Area Harvested (KK Actions) - ha, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX) with Operational Adjustment Factor [osf,osf_mos]
        *SOURCE ohvKKHabyMU.IF(XX=NULL,,tXX) * ySFosf

      ;by State
      FOREACH ZZ IN (#TH10Rep)
      *OUTPUT ohvKKHabyMUstZZ.IF(XX=NULL,,tXX)(_TH2) Area Harvested (KK Actions) - ha, ManagementUnit:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#KK)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ZZ ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") _AREA .IF(YY.rec < YY.count,+)
        ENDFOR
      ENDFOR

      ;by ELC/NDR Zone
      *OUTPUT ohvKKHabyEU.IF(XX=NULL,,tXX)(_TH1) Area Harvested (KK Actions) - ha, Th1Based.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#KK)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") _AREA .IF(YY.rec < YY.count,+)
        ENDFOR

      ;by ELC/NDR Zone with Scalefactor [osf,osf_mos]
      *OUTPUT ohvKKHabyEU.IF(XX=NULL,,tXX)sf(_TH1) Area Harvested (KK Actions) - ha, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX) with Operational Adjustment Factor [osf,osf_mos]
        *SOURCE ohvKKHabyEU.IF(XX=NULL,,tXX) * ySFosf

      ;Harvest by SUSMAI Class
      FOREACH ZZ IN(#TH13Rep,NULL) ;NBM SUSMAI Class
      *OUTPUT ohvKKHabyEUnbmclsZZ.IF(XX=NULL,,tXX)sf(_TH1) Area Harvested (KK Actions) - ha, ManagementUnit:ThemeBased.IF(ZZ=NULL, , - SUSMAICls:ZZ).IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#KK)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") _AREA * .IF(#isMosAdjActYY = 1,ySFosf,ySFosfNoMos) .IF(YY.rec < YY.count,+)
        ENDFOR
      ENDFOR

    ENDFOR ;KK Action List
  ENDFOR ;XX Triad Zone
;<ENDGROUP> TreatmentArea


*GROUP AverageHarvestAttributes; <GROUP>
  FOREACH XX IN(HF,EM,NULL)

    ;Harvest Average Age
    ;-------------------------------------------------------------------
    FOREACH KK IN (acHV,acCC)
      *OUTPUT ohAvAgeYldKKbyMU.IF(XX=NULL,,tXX)(_TH2)     Total Age Yield of Harvest (KK) age*ha, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        FOREACH YY IN(#KK)
          .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") _AGE .IF(YY.rec < YY.count,+)
        ENDFOR
      *OUTPUT ohAvAgeKKbyMU.IF(XX=NULL,,tXX)(_TH2)        Average Age of Harvest (KK) - age, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        *SOURCE ohAvAgeYldKKbyMU.IF(XX=NULL,,tXX) / ohvKKHabyMU.IF(XX=NULL,,tXX)
    ENDFOR


    ;Harvest Average Volume
    ;-------------------------------------------------------------------
    FOREACH KK IN (acHV,acCC)
      *OUTPUT oKKvTbyMU.IF(XX=NULL,,tXX)(_TH2)        Total Harvest (KK) Volume, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        *SOURCE oKKvHbyMU.IF(XX=NULL,,tXX) + oKKvSbyMU.IF(XX=NULL,,tXX)
      *OUTPUT ohAvTVolKKbyMU.IF(XX=NULL,,tXX)(_TH2)        Average Harvest Volume (KK) - age, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
        *SOURCE oKKvTbyMU.IF(XX=NULL,,tXX) / ohvKKHabyMU.IF(XX=NULL,,tXX)
    ENDFOR


    ;Average MAI
    ;-------------------------------------------------------------------
    FOREACH KK IN (T,S,H) ;,SPBF,PIEHTL,SMYB,IHBERO)
      FOREACH JJ IN (acHV,acCC)
        ;KKMAI XX
        *OUTPUT ohAvKKMAIyldJJbyMU.IF(XX=NULL,,tXX)(_TH2)     Total Inventory of Clearcut Harvest MAI - (m3/ha/yr)*ha, ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
          FOREACH YY IN(#JJ)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKMAI .IF(YY.rec < YY.count,+)
          ENDFOR
        *OUTPUT ohAvKKMAIJJbyMU.IF(XX=NULL,,tXX)(_TH2)        Average Clearcut Harvest MAI - (m3/ha/yr), ManagementUnit:ThemeBased.IF(XX=NULL, , Triad Zone XX)
          *SOURCE ohAvKKMAIyldJJbyMU.IF(XX=NULL,,tXX) / ohvJJHabyMU.IF(XX=NULL,,tXX)

        ;KKMAI XX by State
        FOREACH ZZ IN (#TH10Rep)
          *OUTPUT ohAvKKMAIyldJJbyMUstZZ.IF(XX=NULL,,tXX)(_TH2)     Total Inventory of Clearcut Harvest MAI - (m3/ha/yr)*ha, ManagementUnit:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)
            FOREACH YY IN(#JJ)
              .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ZZ ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YKKMAI .IF(YY.rec < YY.count,+)
            ENDFOR
          *OUTPUT ohAvKKMAIJJbyMUstZZ.IF(XX=NULL,,tXX)(_TH2)        Average Clearcut Harvest MAI - (m3/ha/yr), ManagementUnit:ThemeBased, State:ZZ.IF(XX=NULL, , Triad Zone XX)
            *SOURCE ohAvKKMAIyldJJbyMUstZZ.IF(XX=NULL,,tXX) / ohvJJHabyMUstZZ.IF(XX=NULL,,tXX)
        ENDFOR
      ENDFOR
    ENDFOR


    ;Average QMD - HPF Regimes Only: Note: the current area weighting will need to be changed to a volume weighting
    ;-------------------------------------------------------------------
    FOREACH KK IN (T) ;,S,H,SPBF,PIEHTL,SMYB,IHBERO)
      FOREACH JJ IN (acHV,acCC)
        *OUTPUT ohAvKKQMDyldJJbyMU.IF(XX=NULL,,tXX)(_TH2)     Total Inventory of Harvest QMD - (cm)*ha, ManagementUnit:ThemeBased
          FOREACH YY IN(#JJ)
            .IF(YY.rec = 1,*SOURCE,       ) ? ? ? ? ? ? ? ? ? ? ? ? ? ? .IF(XX=NULL,?,XX) .REPLACE(.replace(YY,"[","("),"]",")") YMD .IF(YY.rec < YY.count,+)
          ENDFOR
        *OUTPUT ohAvKKQMDJJbyMU.IF(XX=NULL,,tXX)(_TH2)        Average Harvest QMD - (cm), ManagementUnit:ThemeBased
          *SOURCE ohAvKKQMDyldJJbyMU.IF(XX=NULL,,tXX) / ohvJJHabyMU.IF(XX=NULL,,tXX)
      ENDFOR
    ENDFOR

  ENDFOR ;XX Triad Zone

;<ENDGROUP> AverageHarvestAttributes


*GROUP Budgets; <GROUP>
  FOREACH XX IN(HF,EM,NULL)

    ;Budget - sw=$3.00/m3, hw=$0.60/m3
    ;-------------------------------------------------------------------
    FOREACH KK IN(S,H)
      ;Base Area
      *OUTPUT oKKBudgetbyMU.IF(XX=NULL,,tXX)(_TH2)  Total Silviculture Budget From KK Harvest, ManagementUnit:ThemeBased
        *SOURCE oacHVvKKbyMU.IF(XX=NULL,,tXX) * yKKBudgetM3

      ;..With Operational Adjustment Factor [osf,osf_mos]
      *OUTPUT oKKBudgetbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Total Silviculture Budget From Softwood Harvest, ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
        *SOURCE oacHVvKKbyMU.IF(XX=NULL,,tXX)sf * yKKBudgetGMT
    ENDFOR
    *OUTPUT otBudgetbyMU.IF(XX=NULL,,tXX)(_TH2)  Total Silviculture Budget From Softwood + Hardwood Harvest, ManagementUnit:ThemeBased
      *SOURCE osBudgetbyMU.IF(XX=NULL,,tXX) + ohBudgetbyMU.IF(XX=NULL,,tXX)
    *OUTPUT otBudgetbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Total Silviculture Budget From Softwood + Hardwood Harvest, ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      *SOURCE osBudgetbyMU.IF(XX=NULL,,tXX)sf + ohBudgetbyMU.IF(XX=NULL,,tXX)sf
    *OUTPUT otBudgetDF4%byMU.IF(XX=NULL,,tXX)(_TH2)  Total Silviculture Budget From Softwood + Hardwood Harvest: Discounted 4%, ManagementUnit:ThemeBased
      *SOURCE otBudgetbyMU.IF(XX=NULL,,tXX) * yDF4%


    ;Silviculture Costs
    ;-------------------------------------------------------------------
    FOREACH KK IN(PTNR,PTVR10,PTVR20,PTVR30,PTIS50,PTIS70,PLm,PLs,PLp,PLh,PLw,PLa)
      ;Base Area
      *OUTPUT oKKCostbyMU.IF(XX=NULL,,tXX)(_TH2)  Cost of KK, ManagementUnit:ThemeBased
        *SOURCE ohvacKKHabyMU.IF(XX=NULL,,tXX) * yKKCostHa

      ;..With Operational Adjustment Factor [osf,osf_mos]
      *OUTPUT oKKCostbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Cost of KK, ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
        *SOURCE oKKCostbyMU.IF(XX=NULL,,tXX) * ySFosf
    ENDFOR


    ;Partial Harvest Costs
    ;-------------------------------------------------------------------
    FOREACH KK IN(CT,SH,IS50,IS70,SL,VR30,VR20,VR10)
      ;Base Area
      *OUTPUT oKKCostbyMU.IF(XX=NULL,,tXX)(_TH2)  Cost of KK, ManagementUnit:ThemeBased
        *SOURCE ohvacKKHabyMU.IF(XX=NULL,,tXX) * yKKCostHa

      ;..With Operational Adjustment Factor [osf,osf_mos]
      *OUTPUT oKKCostbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Cost of KK, ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
        *SOURCE oKKCostbyMU.IF(XX=NULL,,tXX) * ySFosf
    ENDFOR


    ;Aggregate Costs with Anualized Operational Adjustment Factor [osf,osf_mos]
    ;-------------------------------------------------------------------
    *OUTPUT oSilvCostbyMU.IF(XX=NULL,,tXX)sf(_TH2)      Cost of Silviculture all Activities (PT,PLm,PLs,PLp,PLh,PLw,PLa,CT,SH,SL,IS,VR30,VR20,VR10), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(PTNR,PTVR10,PTVR20,PTVR30,PTIS50,PTIS70,PLm,PLs,PLp,PLh,PLw,PLa,CT,SH,SL,IS50,IS70,VR30,VR20,VR10)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

    *OUTPUT oSilvCostNoVRbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Cost of Silviculture  (PT,PLi,PLb,PLn,PLs,PLp,PLh,PLw,PLa,CT,SH,SL,IS50,IS70) without cost for(VR), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(PTNR,PTVR10,PTVR20,PTVR30,PTIS50,PTIS70,PLm,PLs,PLp,PLh,PLw,PLa,CT,SH,IS50,IS70,SL)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

    *OUTPUT oSilvCostNoSLVRbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Cost of Silviculture  (PT,PLi,PLb,PLn,PLs,PLp,PLh,PLw,PLa,CT,SH,IS50,IS70) without cost for (SL,VR), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(PTNR,PTVR10,PTVR20,PTVR30,PTIS50,PTIS70,PLm,PLs,PLp,PLh,PLw,PLa,CT,SH,IS50,IS70)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

    *OUTPUT oSilvCostNoPHbyMU.IF(XX=NULL,,tXX)sf(_TH2)  Cost of Silviculture (PT,PLi,PLb,PLn,PLs,PLp,PLh,PLw,PLa) without Including Partial Harvest Costs (SH,CT,IS,SL,VR), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(PTNR,PTVR10,PTVR20,PTVR30,PTIS50,PTIS70,PLm,PLs,PLp,PLh,PLw,PLa)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

    *OUTPUT oSilvCostPHbyMU.IF(XX=NULL,,tXX)sf(_TH2)      Cost of Silviculture all Partial Harvest Activities (CT,SH,IS,SL,VR30,VR20,VR10), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(CT,SH,IS50,IS70,SL,VR30,VR20,VR10)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

    *OUTPUT oSilvCostPHNoVRbyMU.IF(XX=NULL,,tXX)sf(_TH2)      Cost of Silviculture all Partial Harvest Activities (CT,SH,IS,SL), ManagementUnit:ThemeBased, Operational Adjustment Factor [osf,osf_mos]
      FOREACH YY IN(CT,SH,IS50,IS70,SL)
        .IF(YY.rec = 1,*SOURCE,       ) oYYCostbyMU.IF(XX=NULL,,tXX)sf  .IF(YY.rec < YY.count,+)
      ENDFOR

  ENDFOR ;XX Triad Zone
;<ENDGROUP> Budgets


*GROUP CarbonProducts; <GROUP>
  FOREACH XX IN(EM,HF,NULL)

    ;Harvested Wood Product Pools: Softwood
    ;-------------------------------------------------------------------
    *OUTPUT oSolidSWcByMU.IF(XX=NULL,,tXX)(_TH2) Solid Wood Products - Softwood (t) ;0.9 glv->nlv; 0.37 logv->SolidProduct; 0.215 gmt->tc;
     *SOURCE oacHVvSprSLDByMU.IF(XX=NULL,,tXX)sf * 0.0716

    *OUTPUT oPulpSWtemp1cByMU.IF(XX=NULL,,tXX)(_TH2) pulp from downgraged logs ;0.1 glv->npv; 0.85 wood without bark; 0.215 gmt->tc;...portion of log lost to pulp
     *SOURCE oacHVvSprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0183
    *OUTPUT oPulpSWtemp2cbyMU.IF(XX=NULL,,tXX)(_TH2) pulp from pulpwood        ;0.85 wood without bark; 0.215 gmt->tc;
     *SOURCE oacHVvSprPLPbyMU.IF(XX=NULL,,tXX)sf * 0.183
    *OUTPUT oPulpSWtemp3cbyMU.IF(XX=NULL,,tXX)(_TH2) pulp from mill chips      ;0.9 glv->nlv; 0.38 logv->Pulp; 0.215 gmt->tc;
     *SOURCE oacHVvSprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0735
    *OUTPUT oPulpSWcbyMU.IF(XX=NULL,,tXX)(_TH2) Pulp and Paper Products - Softwood (t)
     *SOURCE oPulpSWtemp1cbyMU.IF(XX=NULL,,tXX) + oPulpSWtemp2cbyMU.IF(XX=NULL,,tXX) + oPulpSWtemp3cbyMU.IF(XX=NULL,,tXX)

    *OUTPUT oBiomassSWtemp1cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass: from degraded log waste (bark)                           ;0.1 glv->npv; 0.15 pulp->bark; 0.195 gmt->tc;...portion of log lost to pulp
     *SOURCE oacHVvSprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.00293
    *OUTPUT oBiomassSWtemp2cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from pulpwood waste (bark)                                ;0.15 pulp->bark; 0.195 gmtBark->tcBark;
     *SOURCE oacHVvSprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0293
    *OUTPUT oBiomassSWtemp3cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from mill waste (bark,sawdust,shavings,trim,waste,fines)  ;0.9 glv->nlv; 0.25 logv->Pulp; 0.215 gmt->tc;
     *SOURCE oacHVvSprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0484
    *OUTPUT oBiomassSWtemp4cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from harvest (tops, waste)  ;0.034 biomass harvest; 0.215 gmt->tc;
     *SOURCE oacHVvSbyMU.IF(XX=NULL,,tXX)sf * 0.00731
    *OUTPUT oBiomassSWcbyMU.IF(XX=NULL,,tXX)(_TH2) Biomass Products - Softwood (t)
     *SOURCE oBiomassSWtemp1cbyMU.IF(XX=NULL,,tXX) + oBiomassSWtemp2cbyMU.IF(XX=NULL,,tXX) + oBiomassSWtemp3cbyMU.IF(XX=NULL,,tXX) + oBiomassSWtemp4cbyMU.IF(XX=NULL,,tXX)


    ;Harvested Wood Product Pools: Hardwood
    ;-------------------------------------------------------------------
    *OUTPUT oSolidHWcByMU.IF(XX=NULL,,tXX)(_TH2) Solid Wood Products - Hardwood (t) ;0.9 glv->nlv; 0.37 logv->SolidProduct; 0.215 gmt->tc;
     *SOURCE oacHVvHprSLDByMU.IF(XX=NULL,,tXX)sf * 0.0716

    *OUTPUT oPulpHWtemp1cByMU.IF(XX=NULL,,tXX)(_TH2) pulp from downgraged logs ;0.1 glv->npv; 0.85 wood without bark; 0.215 gmt->tc;...portion of log lost to pulp
     *SOURCE oacHVvHprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0183
    *OUTPUT oPulpHWtemp2cbyMU.IF(XX=NULL,,tXX)(_TH2) pulp from pulpwood        ;0.85 wood without bark; 0.215 gmt->tc;
     *SOURCE oacHVvHprPLPbyMU.IF(XX=NULL,,tXX)sf * 0.183
    *OUTPUT oPulpHWtemp3cbyMU.IF(XX=NULL,,tXX)(_TH2) pulp from mill chips      ;0.9 glv->nlv; 0.38 logv->Pulp; 0.215 gmt->tc;
     *SOURCE oacHVvHprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0735
    *OUTPUT oPulpHWcbyMU.IF(XX=NULL,,tXX)(_TH2) Pulp and Paper Products - Hardwood (t)
     *SOURCE oPulpHWtemp1cbyMU.IF(XX=NULL,,tXX) + oPulpHWtemp2cbyMU.IF(XX=NULL,,tXX) + oPulpHWtemp3cbyMU.IF(XX=NULL,,tXX)

    *OUTPUT oBiomassHWtemp1cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass: from degraded log waste (bark)                           ;0.1 glv->npv; 0.15 pulp->bark; 0.195 gmt->tc;...portion of log lost to pulp
     *SOURCE oacHVvHprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.00293
    *OUTPUT oBiomassHWtemp2cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from pulpwood waste (bark)                                ;0.15 pulp->bark; 0.195 gmtBark->tcBark;
     *SOURCE oacHVvHprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0293
    *OUTPUT oBiomassHWtemp3cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from mill waste (bark,sawdust,shavings,trim,waste,fines)  ;0.9 glv->nlv; 0.25 logv->Pulp; 0.215 gmt->tc;
     *SOURCE oacHVvHprSLDbyMU.IF(XX=NULL,,tXX)sf * 0.0484
    *OUTPUT oBiomassHWtemp4cbyMU.IF(XX=NULL,,tXX)(_TH2) biomass from harvest (tops, waste)  ;0.192 biomass harvest; 0.215 gmt->tc;
     *SOURCE oacHVvHbyMU.IF(XX=NULL,,tXX)sf * 0.04128
    *OUTPUT oBiomassHWcbyMU.IF(XX=NULL,,tXX)(_TH2) Biomass Products - Hardwood (t)
     *SOURCE oBiomassHWtemp1cbyMU.IF(XX=NULL,,tXX) + oBiomassHWtemp2cbyMU.IF(XX=NULL,,tXX) + oBiomassHWtemp3cbyMU.IF(XX=NULL,,tXX) + oBiomassHWtemp4cbyMU.IF(XX=NULL,,tXX)

    ;Harvested Wood Product Pools: Totals
    *OUTPUT oTotalHWPcbyMU.IF(XX=NULL,,tXX)(_TH2) Harvested Wood Products (t)
     *SOURCE oSolidSWcbyMU.IF(XX=NULL,,tXX)   + oSolidHWcbyMU.IF(XX=NULL,,tXX)  +
             oPulpSWcbyMU.IF(XX=NULL,,tXX)    + oPulpHWcbyMU.IF(XX=NULL,,tXX)   +
             oBiomassSWcbyMU.IF(XX=NULL,,tXX) + oBiomassHWcbyMU.IF(XX=NULL,,tXX)


    ;Harvested Wood Product Pools: Cumulative
    ;-------------------------------------------------------------------
    ;Softwood - solid wood products
    *OUTPUT oCulmSolidSWcT1.IF(XX=NULL,,tXX)(_TH2) Cumulative temp1 - Solid Wood Products - Softwood
     *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX) + oSolidSWcByMU.IF(XX=NULL,,tXX)[-1] * 0.906 +  oSolidSWcByMU.IF(XX=NULL,,tXX)[-2] * 0.82 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-3] * 0.743 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-4] * 0.673
    *OUTPUT oCulmSolidSWcT2.IF(XX=NULL,,tXX)(_TH2) Cumulative temp2 - Solid Wood Products - Softwood
     *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-5] * 0.610 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-6] * 0.552 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-7] * 0.5 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-8] * 0.453
    *OUTPUT oCulmSolidSWcT3.IF(XX=NULL,,tXX)(_TH2) Cumulative temp3 - Solid Wood Products - Softwood
     *SOURCE  oSolidSWcByMU.IF(XX=NULL,,tXX)[-9] * 0.41 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-10] + oSolidSWcByMU.IF(XX=NULL,,tXX)[-11] * 0.336 +  oSolidSWcByMU.IF(XX=NULL,,tXX)[-12] * 0.305
    *OUTPUT oCulmSolidSWcT4.IF(XX=NULL,,tXX)(_TH2) Cumulative temp4 - Solid Wood Products - Softwood
     *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-13] * 0.276 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-14] * 0.25  + oSolidSWcByMU.IF(XX=NULL,,tXX)[-15] * 0.226 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-16] * 0.205
    *OUTPUT oCulmSolidSWT5c.IF(XX=NULL,,tXX)(_TH2) Cumulative temp5 - Solid Wood Products - Softwood
     *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-17] * 0.186 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-18] * 0.168 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-19] * 0.152 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-20] * 0.138
    *OUTPUT oCulmSolidSWcByMU.IF(XX=NULL,,tXX)(_TH2) Cumulative - Solid Wood Products - Softwood
     *SOURCE oCulmSolidSWcT1.IF(XX=NULL,,tXX) + oCulmSolidSWcT2.IF(XX=NULL,,tXX) + oCulmSolidSWcT3.IF(XX=NULL,,tXX) + oCulmSolidSWcT4.IF(XX=NULL,,tXX) + oCulmSolidSWT5c.IF(XX=NULL,,tXX)


    ;Hardwood - solid wood products
    ;-------------------------------------------------------------------
    *OUTPUT oCulmSolidHWcT1.IF(XX=NULL,,tXX)(_TH2) Cumulative temp1 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX) + oSolidHWcByMU.IF(XX=NULL,,tXX)[-1] * 0.906 +  oSolidHWcByMU.IF(XX=NULL,,tXX)[-2] * 0.82 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-3] * 0.743 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-4] * 0.673
    *OUTPUT oCulmSolidHWcT2.IF(XX=NULL,,tXX)(_TH2) Cumulative temp2 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-5] * 0.610 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-6] * 0.552 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-7] * 0.5 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-8] * 0.453
     *OUTPUT oCulmSolidHWcT3.IF(XX=NULL,,tXX)(_TH2) Cumulative temp3 - Solid Wood Products - Hardwood
      *SOURCE  oSolidHWcByMU.IF(XX=NULL,,tXX)[-9] * 0.41 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-10] + oSolidHWcByMU.IF(XX=NULL,,tXX)[-11] * 0.336 +  oSolidHWcByMU.IF(XX=NULL,,tXX)[-12] * 0.305
    *OUTPUT oCulmSolidHWcT4.IF(XX=NULL,,tXX)(_TH2) Cumulative temp4 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-13] * 0.276 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-14] * 0.25  + oSolidHWcByMU.IF(XX=NULL,,tXX)[-15] * 0.226 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-16] * 0.205
    *OUTPUT oCulmSolidHWT5c.IF(XX=NULL,,tXX)(_TH2) Cumulative temp5 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-17] * 0.186 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-18] * 0.168 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-19] * 0.152 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-20] * 0.138
    *OUTPUT oCulmSolidHWcByMU.IF(XX=NULL,,tXX)(_TH2) Cumulative - Solid Wood Products - Hardwood
     *SOURCE oCulmSolidHWcT1.IF(XX=NULL,,tXX) + oCulmSolidHWcT2.IF(XX=NULL,,tXX) + oCulmSolidHWcT3.IF(XX=NULL,,tXX) + oCulmSolidHWcT4.IF(XX=NULL,,tXX) + oCulmSolidHWT5c.IF(XX=NULL,,tXX)


    ;Softwood - pulp and paper products
    ;-------------------------------------------------------------------
    *OUTPUT oCulmPulpSWcByMU.IF(XX=NULL,,tXX)(_TH2) Cumulative - Pulp and Paper Products - Softwood
      *SOURCE oPulpSWcbyMU.IF(XX=NULL,,tXX) + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-1] * 0.177 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-2] * 0.031 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-3] * 0.006 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-4] * 0.001


    ;Hardwood - pulp and paper products
    ;-------------------------------------------------------------------
    *OUTPUT oCulmPulpHWcByMU.IF(XX=NULL,,tXX)(_TH2) Cumulative - Pulp and Paper Products - Hardwood
      *SOURCE oPulpHWcbyMU.IF(XX=NULL,,tXX) + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-1] * 0.177 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-2] * 0.031 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-3] * 0.006 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-4] * 0.001


    ;All harvested wood products
    ;-------------------------------------------------------------------
    *OUTPUT oCulmHWPcByMU.IF(XX=NULL,,tXX)(_TH2) Cumulative Harvested Wood Products (t)
      *SOURCE oCulmSolidSWcByMU.IF(XX=NULL,,tXX) + oCulmSolidHWcByMU.IF(XX=NULL,,tXX) + oCulmPulpSWcByMU.IF(XX=NULL,,tXX) + oCulmPulpHWcByMU.IF(XX=NULL,,tXX)

  ENDFOR
;<ENDGROUP> CarbonProducts



*GROUP Carbon; <GROUP>
  FOREACH XX IN(EM,HF,NULL)
    FOREACH ZZ IN(WLB,RLB,NULL)

      ;Forest Carbon Pools
      ;-------------------------------------------------------------------
      ;Live Biomass
      *OUTPUT oBioc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Total Biomass Carbon (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yB
      ;Dead Organic Matter Excluding Soil Pools
      *OUTPUT oDOMNoSoilc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Dead Organic Matter Excluding Soils (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yD
      ;Dead Organic Matter Soil Only Pools
      *OUTPUT oSoilc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Soil Dead Organic Matter (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yS
      ;Total Forest Pools: Bio+DomNoSoil+Soil
      *OUTPUT oForc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Total Forest Carbon (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yB +
                ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yD +
                ? ? ? ? ? ? ? ? ? ? .IF(ZZ=NULL,?,ZZ) .IF(ZZ=NULL,?,ZZ) ? ? .IF(XX=NULL,?,XX)  _INVENT yS


      ;Atmosphere Pools: From Forest
      ;-------------------------------------------------------------------
      ;Live Biomass
      *OUTPUT oATMBioc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Net Carbon Flux from Biomass (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yATMBIOc
      *OUTPUT oBiocEmissions.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Emissions from Biomass (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yBiocEmissions
      *OUTPUT oBiocRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Removals from Biomass (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yBiocRemovals
      ;Dead Organic Matter Including Soil
        *OUTPUT oATMDOMc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Net Carbon Flux from DOM (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yATMDOMc * yATMDOMMask
      *OUTPUT oDOMcEmissions.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Emissions from DOM (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yDOMcEmissions * yATMDOMMask
      *OUTPUT oDOMcRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Removals from DOM (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? _INVENT yDOMcRemovals * yATMDOMMask
      ;Total Forest Pools: Bio+DOM
      *OUTPUT oATMForc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Net Carbon Flux from Forest(Bio+Dom+Soil) (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE oATMBioc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX) + oATMDOMc.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)
      *OUTPUT oForcEmissions.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Emissions from Forest(Bio+Dom+Soil) (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE oBiocEmissions.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX) + oDOMcEmissions.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)
      *OUTPUT oForcRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)(_TH2) Carbon Removals from Forest(Bio+Dom+Soil) (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX)
        *SOURCE oBiocRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX) + oDOMcRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)
      *OUTPUT oForcRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX)DF4%(_TH2) Carbon Removals from Forest(Bio+Dom+Soil) (t) .IF(ZZ=NULL,,-ZZ).IF(XX=NULL,,-XX) DF4%
        *SOURCE oForcRemovals.IF(ZZ=NULL,,ZZ)byMU.IF(XX=NULL,,tXX) * yDF4%

    ENDFOR

    ;Forest Carbon Pools
    ;-------------------------------------------------------------------
    *OUTPUT oForHWPc.IF(XX=NULL,,tXX)(_TH2) Total Forest and Harvested Wood Product Carbon (t) .IF(XX=NULL,,-XX)
     *SOURCE oCulmHWPcByMU.IF(XX=NULL,,tXX) + oForcbyMU.IF(XX=NULL,,tXX)

    *OUTPUT oForHWPc.IF(XX=NULL,,tXX)DF4%(_TH2) Total Forest and Harvested Wood Product Carbon (t) .IF(XX=NULL,,-XX) DF4%
     *SOURCE oForHWPc.IF(XX=NULL,,tXX) * yDF4%

    ;Atmosphere Pools: Total: From Forest + Harvested Wood Products
    ;-------------------------------------------------------------------
    ;Product Emissions
    ;Softwood - pulp and paper products
    *OUTPUT oPulpSWEmissions.IF(XX=NULL,,tXX)(_TH2) Emissions from Pulp and Paper Products - Softwood (t)
      *SOURCE oPulpSWcbyMU.IF(XX=NULL,,tXX)[-1] * 0.823 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-2] * 0.146 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-3] * 0.026 + oPulpSWcbyMU.IF(XX=NULL,,tXX)[-4] * 0.005
    ;Hardwood - pulp and paper products
    *OUTPUT oPulpHWEmissions.IF(XX=NULL,,tXX)(_TH2) Emissions from Pulp and Paper Products - Hardwood (t)
      *SOURCE oPulpHWcbyMU.IF(XX=NULL,,tXX)[-1] * 0.823 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-2] * 0.146 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-3] * 0.026 + oPulpHWcbyMU.IF(XX=NULL,,tXX)[-4] * 0.005
    ;Softwood and hardwood - biomass emissions
    *OUTPUT oBiomassEmissions.IF(XX=NULL,,tXX)(_TH2) Emissions from Biomass Products (t)
      *SOURCE oBiomassHWcbyMU.IF(XX=NULL,,tXX) + oBiomassSWcbyMU.IF(XX=NULL,,tXX)
    ;Softwood - solid wood products
    *OUTPUT oSolidSWEmissionsT1.IF(XX=NULL,,tXX)(_TH2) Emissions temp1 - Solid Wood Products - Softwood
      *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-1] * 0.094 +  oSolidSWcByMU.IF(XX=NULL,,tXX)[-2] * 0.085 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-3] * 0.077 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-4] * 0.070
    *OUTPUT oSolidSWEmissionsT2.IF(XX=NULL,,tXX)(_TH2) Emissions temp2 - Solid Wood Products - Softwood
      *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-5] * 0.063 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-6] * 0.057 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-7] * 0.052 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-8] * 0.047
    *OUTPUT oSolidSWEmissionsT3.IF(XX=NULL,,tXX)(_TH2) Emissions temp3 - Solid Wood Products - Softwood
      *SOURCE  oSolidSWcByMU.IF(XX=NULL,,tXX)[-9] * 0.043 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-10] * 0.039 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-11] * 0.035 +  oSolidSWcByMU.IF(XX=NULL,,tXX)[-12] * 0.032
    *OUTPUT oSolidSWEmissionsT4.IF(XX=NULL,,tXX)(_TH2) Emissions temp4 - Solid Wood Products - Softwood
      *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-13] * 0.029 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-14] * 0.026  + oSolidSWcByMU.IF(XX=NULL,,tXX)[-15] * 0.024 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-16] * 0.021
    *OUTPUT oSolidSWEmissionsT5.IF(XX=NULL,,tXX)(_TH2) Emissions temp5 - Solid Wood Products - Softwood
      *SOURCE oSolidSWcByMU.IF(XX=NULL,,tXX)[-17] * 0.019 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-18] * 0.018 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-19] * 0.016 + oSolidSWcByMU.IF(XX=NULL,,tXX)[-20] * 0.014
    *OUTPUT oSolidSWEmissions.IF(XX=NULL,,tXX)(_TH2) Emissions from Solid Wood Products - Softwood (t)
      *SOURCE oSolidSWEmissionsT1.IF(XX=NULL,,tXX) + oSolidSWEmissionsT2.IF(XX=NULL,,tXX) + oSolidSWEmissionsT3.IF(XX=NULL,,tXX) + oSolidSWEmissionsT4.IF(XX=NULL,,tXX) + oSolidSWEmissionsT5.IF(XX=NULL,,tXX)
    ;Hardwood - solid wood products
    *OUTPUT oSolidHWEmissionsT1.IF(XX=NULL,,tXX)(_TH2) Emissions temp1 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-1] * 0.094 +  oSolidHWcByMU.IF(XX=NULL,,tXX)[-2] * 0.085 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-3] * 0.077 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-4] * 0.070
    *OUTPUT oSolidHWEmissionsT2.IF(XX=NULL,,tXX)(_TH2) Emissions temp2 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-5] * 0.063 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-6] * 0.057 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-7] * 0.052 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-8] * 0.047
    *OUTPUT oSolidHWEmissionsT3.IF(XX=NULL,,tXX)(_TH2) Emissions temp3 - Solid Wood Products - Hardwood
      *SOURCE  oSolidHWcByMU.IF(XX=NULL,,tXX)[-9] * 0.043 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-10] * 0.039 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-11] * 0.035 +  oSolidHWcByMU.IF(XX=NULL,,tXX)[-12] * 0.032
    *OUTPUT oSolidHWEmissionsT4.IF(XX=NULL,,tXX)(_TH2) Emissions temp4 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-13] * 0.029 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-14] * 0.026  + oSolidHWcByMU.IF(XX=NULL,,tXX)[-15] * 0.024 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-16] * 0.021
    *OUTPUT oSolidHWEmissionsT5.IF(XX=NULL,,tXX)(_TH2) Emissions temp5 - Solid Wood Products - Hardwood
      *SOURCE oSolidHWcByMU.IF(XX=NULL,,tXX)[-17] * 0.019 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-18] * 0.018 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-19] * 0.016 + oSolidHWcByMU.IF(XX=NULL,,tXX)[-20] * 0.014
    *OUTPUT oSolidHWEmissions.IF(XX=NULL,,tXX)(_TH2) Emissions from Solid Wood Products - Hardwood (t)
      *SOURCE oSolidHWEmissionsT1.IF(XX=NULL,,tXX) + oSolidHWEmissionsT2.IF(XX=NULL,,tXX) + oSolidHWEmissionsT3.IF(XX=NULL,,tXX) + oSolidHWEmissionsT4.IF(XX=NULL,,tXX) + oSolidHWEmissionsT5.IF(XX=NULL,,tXX)
    ;Total Emissions from products
    *OUTPUT oATMHWPcbyMU.IF(XX=NULL,,tXX)(_TH2) Total Emissions from Solid Wood Products (t)
      *SOURCE oPulpSWEmissions.IF(XX=NULL,,tXX) + oPulpHWEmissions.IF(XX=NULL,,tXX) + oBiomassEmissions.IF(XX=NULL,,tXX) + oSolidSWEmissions.IF(XX=NULL,,tXX) + oSolidHWEmissions.IF(XX=NULL,,tXX)

    ;Total Emissions and Removals from Forests and Products
    *OUTPUT oATMTotalcbyMU.IF(XX=NULL,,tXX)(_TH2) Net Carbon Flux from Forests and Products (t) .IF(XX=NULL,,-XX)
      *SOURCE oATMForcbyMU.IF(XX=NULL,,tXX) + oATMHWPcbyMU.IF(XX=NULL,,tXX)
    *OUTPUT oTotalEmissions.IF(XX=NULL,,tXX)(_TH2) Total Emissions from Forests and Products (t) .IF(XX=NULL,,-XX)
      *SOURCE oForcEmissionsbyMU.IF(XX=NULL,,tXX) + oATMHWPcbyMU.IF(XX=NULL,,tXX)
    *OUTPUT oTotalRemovals.IF(XX=NULL,,tXX)(_TH2) Total Removals from Forests and Products (t) .IF(XX=NULL,,-XX)
      *SOURCE  oForcRemovalsbyMU.IF(XX=NULL,,tXX) + oATMHWPcbyMU.IF(XX=NULL,,tXX)

  ENDFOR
;<ENDGROUP> Carbon

*GROUP ClimateChange; <GROUP>
  ;Climate Change Vulnerability Index - Species Level
  FOREACH XX IN(RS,BS,WS,BF,WP,RP,EH,TL,RM,WB,XA,SM,BE,YB,RO)
    FOREACH ZZ IN(EM,HF,NULL)
      FOREACH JJ IN(WLB,RLB,NULL)
        FOREACH KK IN(#opERs,NULL)
         *OUTPUT oCCVXX.IF(KK=NULL,,KK)RCP26.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability XX KK .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) RCP 2.6
          *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yXXrcp26
         *OUTPUT oCCVXX.IF(KK=NULL,,KK)RCP85.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability XX KK .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) RCP 8.5
          *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yXXrcp85
        ENDFOR
      ENDFOR
    ENDFOR
  ENDFOR
  FOREACH ZZ IN(EM,HF,NULL)
    FOREACH JJ IN(WLB,RLB,NULL)
     FOREACH KK IN(#opERs,NULL)
          ;Climate Change Vulnerability Index - Ecoregion Level
          *OUTPUT oCCV.IF(KK=NULL,,KK)RCP26.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 2.6 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ)
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVrcp26
          *OUTPUT oCCV.IF(KK=NULL,,KK)RCP85.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 8.5 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ)
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVrcp85
          ;Climate Change Vulnerability Index - Reduced weights for LIT species
          *OUTPUT oCCV.IF(KK=NULL,,KK)RCP26red.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 2.6 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) REDUCED
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVrcp26red
          *OUTPUT oCCV.IF(KK=NULL,,KK)RCP85red.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 8.5 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) REDUCED
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVrcp85red

          *OUTPUT oCCVLIT.IF(KK=NULL,,KK)RCP26.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 2.6 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) LIT
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVLITrcp26
          *OUTPUT oCCVNonLIT.IF(KK=NULL,,KK)RCP26.IF(ZZ=NULL,,tZZ).IF(JJ=NULL,,JJ)(_TH2) Climate Change Vulnerability .IF(KK=NULL,,KK) RCP 2.6 .IF(ZZ=NULL,,tZZ) .IF(JJ=NULL,,JJ) Non-LIT
           *SOURCE .IF(KK=NULL,?,KK) ? ? ? ? ? ? ? ? ? .IF(JJ=NULL,?,JJ) .IF(JJ=NULL,?,JJ) ? ? .IF(ZZ=NULL,?,ZZ)  _INVENT yCCVNonLITrcp26
     ENDFOR
    ENDFOR
  ENDFOR
;<ENDGROUP> ClimateChange



